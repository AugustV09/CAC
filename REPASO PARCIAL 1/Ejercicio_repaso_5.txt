      PIO EQU 30H ; POSICION DEL REGISTRO PA DE LA PIO


      ORG 3000H
A:
      PUSH AX
      MOV DL,0    ; INICIALIZO DL COMO "TRUE"
      AND AL,0FFH  ; ESTA MASCARA EVALUA SI TODAS LAS LUCES ESTAN APAGADAS
      JNZ FIN_A
      MOV DL,1
FIN_A:
      POP AX
      RET

B:
      PUSH AX
      NOT AL  ; NIEGO LAS LLAVES
      OUT PIO+1,AL  ; COLOCO EL RESULTADO DE LA PREVIA NEGACION EN LAS LUCES
      POP AX
      RET

C:
      PUSH AX
      AND AL,1  ; ME FIJO SI LA LLAVE MENOS SIGNIFICATIVA ESTA ENCENDIDA
      JZ FIN_C
      PUSH BX
      PUSH CX
      MOV BX,OFFSET MSJ
      MOV AL, OFFSET FIN - OFFSET MSJ
      INT 7  ; IMPRIMO MSJ
      POP CX
      POP BX
FIN_C:
      POP AX
      RET

      ORG 1000H
MSJ   DB  "Arquitectura de Computadoras: ACTIVADA"
FIN   DB ?
  
      ORG 2000H
      MOV AL,0FFH
      OUT PIO+2,AL  ; CONFIGURO PA COMO ENTRADA (CA = 11111111)
      MOV AL,0
      OUT PIO+3,AL  ; CONFIGURO PB COMO SALIDA (CB = 0)
      IN AL, PIO
      CALL A
      CMP DL,1  ; SI NO SE CUMPLE ESTA CONDICION, TERMINO EL PROGRAMA
      JZ FINAL
      CALL B
      CALL C

; TODAS LAS SUBRUTINAS SON INDEPENDIENTES DEBIDO A QUE HAGO PUSH DE AX DENTRO DE CADA UNA (ADEMAS DE OTROS PUSHES SEGUN CORRESPONDA)
      
FINAL:
      HLT
      END